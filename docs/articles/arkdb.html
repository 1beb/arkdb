<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to arkdb • arkdb</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to arkdb">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">arkdb</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/arkdb.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cboettig/arkdb">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to arkdb</h1>
                        <h4 class="author">Carl Boettiger</h4>
            
            <h4 class="date">2018-07-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cboettig/arkdb/blob/master/vignettes/arkdb.Rmd"><code>vignettes/arkdb.Rmd</code></a></small>
      <div class="hidden name"><code>arkdb.Rmd</code></div>

    </div>

    
    
<div id="arkdb" class="section level1">
<h1 class="hasAnchor">
<a href="#arkdb" class="anchor"></a>arkdb</h1>
<div id="package-rationale" class="section level2">
<h2 class="hasAnchor">
<a href="#package-rationale" class="anchor"></a>Package rationale</h2>
<p>Increasing data sizes create challenges for the fundamental tasks of publishing, distributing, and preserving data. Despite (or perhaps because of) the diverse and ever-expanding number of database and file formats, the humble plain text file such as comma or tab-separated-values <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> (<code>.tsv</code> files) remains the gold standard for data archiving and distribution. These files can read on almost any platform or tool and can be efficiently compressed using long-standing and widely available standard open source libraries like <code>gzip</code> or <code>bzip2</code>. In contrast, database storage formats and dumps are usually particular to the database platform used to generate them, and will likely not be compatible between different database engines (e.g. PostgreSQL -&gt; SQLite) or even between different versions of the same engine. Researchers unfamiliar with these databases will have difficulty accessing such data, and these dumps may also be in formats that are less efficient to compress.</p>
<p>Working with tables that are too large for working memory on most machines by using external relational database stores is now a common R practice, thanks to ever-rising availability of data and increasing support and popularity of packages such as <code>DBI</code>, <code>dplyr</code>, and <code>dbplyr</code>. Working with plain text files becomes increasingly difficult in this context. Many R users will not have sufficient RAM to simply read in a 10 GB <code>.tsv</code> file into R. Similarly, moving a 10 GB database out of a relational data file and into a plain text file for archiving and distribution is similarly challenging from R. While most relational database back-ends implement some form of <code>COPY</code> or <code>IMPORT</code> that allows them to read in and export out plain text files directly, these methods are not consistent across database types and not part of the standard SQL interface. Most importantly for our case, they also cannot be called directly from R, but require a separate stand-alone installation of the database client. <code>arkdb</code> provides a simple solution to these two tasks.</p>
<p>The goal of <code>arkdb</code> is to provide a convenient way to move data from large compressed text files (e.g. <code>*.tsv.bz2</code>) into any DBI-compliant database connection (see <a href="https://db.rstudio.com/dbi/">DBI</a>), and move tables out of such databases into text files. The key feature of <code>arkdb</code> is that files are moved between databases and text files in chunks of a fixed size, allowing the package functions to work with tables that would be much to large to read into memory all at once. This will be slower than reading the file into memory at one go, but can be scaled to larger data and larger data with no additional memory requirement.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install arkdb from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"cboettig/arkdb"</span>)</a></code></pre></div>
</div>
</div>
<div id="tutorial" class="section level1">
<h1 class="hasAnchor">
<a href="#tutorial" class="anchor"></a>Tutorial</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(arkdb)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># additional libraries just for this demo</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">library</span>(dbplyr)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">library</span>(nycflights13)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">library</span>(fs)</a></code></pre></div>
<div id="creating-an-archive-of-an-existing-database" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-archive-of-an-existing-database" class="anchor"></a>Creating an archive of an existing database</h2>
<p>First, we’ll need an example database to work with. Conveniently, there is a nice example using the NYC flights data built into the dbplyr package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">db &lt;-<span class="st"> </span>dbplyr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/dbplyr/topics/nycflights13">nycflights13_sqlite</a></span>(<span class="st">"."</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; Caching nycflights db at ./nycflights13.sqlite</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; Creating table: airlines</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; Creating table: airports</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; Creating table: flights</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; Creating table: planes</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; Creating table: weather</span></a></code></pre></div>
<p>To create an archive, we just give <code>ark</code> the connection to the database and tell it where we want the <code>*.tsv.bz2</code> files to be archived. We can also set the chunk size as the number of <code>lines</code> read in a single chunk. More lines per chunk usually means faster run time at the cost of higher memory requirements.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">dir &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/create.html">dir_create</a></span>(<span class="st">"nycflights"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="../reference/ark.html">ark</a></span>(db, dir, <span class="dt">lines =</span> <span class="dv">50000</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; Exporting in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; airlines</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; ...Done! (in 0.006915092 secs)</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; Exporting in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; airports</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; ...Done! (in 0.03431201 secs)</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; Exporting in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; flights</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; ...Done! (in 8.867065 secs)</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; Exporting in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; planes</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt; ...Done! (in 0.08900714 secs)</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt; Exporting in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt; weather</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt; Warning: Closing open result set, pending rows</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt; ...Done! (in 0.5343661 secs)</span></a></code></pre></div>
<p>We can take a look and confirm the files have been written. Note that we can use <code><a href="http://fs.r-lib.org/reference/dir_ls.html">fs::dir_info</a></code> to get a nice snapshot of the file sizes. Compare the compressed sizes to the original database:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/dir_ls.html">dir_info</a></span>(dir) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(path, size)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; # A tibble: 5 x 2</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;   path                               size</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;   &lt;fs::path&gt;                  &lt;fs::bytes&gt;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 1 nycflights/airlines.tsv.bz2         260</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 2 nycflights/airports.tsv.bz2      28.17K</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 3 nycflights/flights.tsv.bz2        4.88M</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 4 nycflights/planes.tsv.bz2        11.96K</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 5 nycflights/weather.tsv.bz2      283.15K</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/file_info.html">file_info</a></span>(<span class="st">"nycflights13.sqlite"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(path, size)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; # A tibble: 1 x 2</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;   path                       size</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;   &lt;fs::path&gt;          &lt;fs::bytes&gt;</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 1 nycflights13.sqlite       44.9M</span></a></code></pre></div>
</div>
<div id="unarchive" class="section level2">
<h2 class="hasAnchor">
<a href="#unarchive" class="anchor"></a>Unarchive</h2>
<p>Now that we’ve gotten all the database into (compressed) plain text files, let’s get them back out. We simply need to pass <code>unark</code> a list of these compressed files and a connection to the database. Here we create a new local SQLite database. Note that this design means that it is also easy to use <code>arkdb</code> to move data between databases.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">files &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span>(dir, <span class="dt">glob =</span> <span class="st">"*.tsv.bz2"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">new_db &lt;-<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/src_dbi.html">src_sqlite</a></span>(<span class="st">"local.sqlite"</span>, <span class="dt">create=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>As with <code>ark</code>, we can set the chunk size to control the memory footprint required:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/unark.html">unark</a></span>(files, new_db, <span class="dt">lines =</span> <span class="dv">50000</span>)  </a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; Importing in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; nycflights/airlines.tsv.bz2</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; ...Done! (in 0.0483489 secs)</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; Importing in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; nycflights/airports.tsv.bz2</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; ...Done! (in 0.02760291 secs)</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; Importing in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; nycflights/flights.tsv.bz2</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; ...Done! (in 6.605275 secs)</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; Importing in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; nycflights/planes.tsv.bz2</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; ...Done! (in 0.04008579 secs)</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; Importing in 50000 line chunks:</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; nycflights/weather.tsv.bz2</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; ...Done! (in 0.2508781 secs)</span></a></code></pre></div>
<p><code>unark</code> returns a <code>dplyr</code> database connection that we can use in the usual way:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span>(new_db, <span class="st">"flights"</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; # Source:   table&lt;flights&gt; [?? x 19]</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; # Database: sqlite 3.22.0 [local.sqlite]</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;int&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt;  1  2013     1     1      517            515         2      830</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  2  2013     1     1      533            529         4      850</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;  3  2013     1     1      542            540         2      923</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;  4  2013     1     1      544            545        -1     1004</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;  5  2013     1     1      554            600        -6      812</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;  6  2013     1     1      554            558        -4      740</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;  7  2013     1     1      555            600        -5      913</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  8  2013     1     1      557            600        -3      709</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  9  2013     1     1      557            600        -3      838</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; 10  2013     1     1      558            600        -2      753</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; # ... with more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; #   arr_delay &lt;int&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;int&gt;, distance &lt;int&gt;, hour &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; #   minute &lt;int&gt;, time_hour &lt;dbl&gt;</span></a></code></pre></div>
</div>
<div id="a-note-on-compression" class="section level2">
<h2 class="hasAnchor">
<a href="#a-note-on-compression" class="anchor"></a>A note on compression</h2>
<p><code>unark</code> can read from a variety of compression formats recognized by base R: <code>bzip2</code>, <code>gzip</code>, <code>zip</code>, and <code>xz</code>, and <code>ark</code> can choose any of these as the compression algorithm. Note that there is some trade-off between speed of compression and efficiency (i.e. the final file size). <code>ark</code> uses the <code>bz2</code> compression algorithm by default, supported in base R, to compress <code>tsv</code> files. The <code>bz2</code> offers excellent compression levels, but is considerably slower to compress than <code>gzip</code> or <code>zip</code>. It is comparably fast to uncompress. For faster archiving when maximum file size reduction is not critical, <code>gzip</code> will give nearly as effective compression in significantly less time.</p>
</div>
<div id="distributing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#distributing-data" class="anchor"></a>Distributing data</h2>
<p>Once you have archived your database files with <code>ark</code>, consider sharing them privately or publicly as part of your project GitHub repo using the <a href="https://github.com/cboettig/piggyback"><code>piggyback</code> R package</a>. For more permanent, versioned, and citable data archiving, upload your <code>*.tsv.bz2</code> files to a data repository like <a href="https://zenodo.org">Zenodo.org</a>.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The <code>tsv</code> standard is particularly attractive because it side-steps some of the ambiguities present in the CSV format due to string quoting. That is: “when should a comma be a literal part of a text string and when is it the column separator”. The convention that a comma inside quotations is a literal creates a new problem about when is a quote a literal and when is it just quoting a string. The <a href="https://www.iana.org/assignments/media-types/text/tab-separated-values">IANA Standard for TSV</a> neatly avoids this for tab-separated values by insisting that a tab can only ever be a separator. Therefore, quotes are always literal and you never need to worry about escaping them.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#arkdb">arkdb</a><ul class="nav nav-pills nav-stacked">
<li><a href="#package-rationale">Package rationale</a></li>
      <li><a href="#installation">Installation</a></li>
      </ul>
</li>
      <li>
<a href="#tutorial">Tutorial</a><ul class="nav nav-pills nav-stacked">
<li><a href="#creating-an-archive-of-an-existing-database">Creating an archive of an existing database</a></li>
      <li><a href="#unarchive">Unarchive</a></li>
      <li><a href="#a-note-on-compression">A note on compression</a></li>
      <li><a href="#distributing-data">Distributing data</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Carl Boettiger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
